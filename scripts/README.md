# データ移行スクリプト

## 資格セクションのデータ形式変換

### 概要

このスクリプトは、資格セクションの古いデータ形式を新しい形式に変換します。

**古い形式:**
```json
{
  "categories": ["情報", "電気"],
  "items": [
    { "category": "情報", "name": "基本情報技術者試験" },
    { "category": "電気", "name": "第三種電気主任技術者試験" }
  ]
}
```

**新しい形式:**
```json
{
  "items": [
    {
      "title": "情報",
      "items": ["基本情報技術者試験"]
    },
    {
      "title": "電気",
      "items": ["第三種電気主任技術者試験"]
    }
  ]
}
```

### 実行方法

#### 1. Firebase認証情報の準備

`serviceAccountKey.json` ファイルがプロジェクトルートに配置されていることを確認してください。

#### 2. スクリプトの実行

```bash
npm run migrate:certifications
```

### 実行結果の確認

スクリプトを実行すると、以下のような出力が表示されます：

```
🔍 資格セクションを検索中...

📄 セクション: certifications
   表示名: 資格
   タイプ: categorized
   ✅ 古い形式のデータを検出しました
   📊 現在のデータ:
      - カテゴリ数: 2
      - 項目数: 5
   🔄 新しい形式に変換:
      カテゴリ 1: 情報 (3個の項目)
        1. 基本情報技術者試験
        2. 応用情報技術者試験
        3. データベーススペシャリスト
      カテゴリ 2: 電気 (2個の項目)
        1. 第三種電気主任技術者試験
        2. 第二種電気工事士
   💾 データを更新中...
   ✅ 更新完了！

🎉 移行が完了しました！
```

### 注意事項

- スクリプトは実際にFirestoreのデータを更新します
- 実行前にデータのバックアップを取ることを推奨します
- 一度実行したら、同じデータに対して再度実行しても影響はありません（変換不要と判断されます）

### トラブルシューティング

#### エラー: `serviceAccountKey.json` が見つからない

Firebase Consoleから認証情報をダウンロードして、プロジェクトルートに配置してください。

#### エラー: 権限がない

Firebase Admin SDKの認証情報に、Firestoreへの読み書き権限があることを確認してください。
